{% extends "base.html" %}
{% block title %}ุฏุงุดุจูุฑุฏ{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto mt-10 space-y-8 px-6 sm:px-0">

    <!-- ุฎูุด ุขูุฏฺฏู -->
    <section class="bg-white border border-gray-200 shadow-lg rounded-3xl p-8 transition-all hover:shadow-xl hover:border-gray-300">
        <h1 class="text-3xl font-bold text-brand mb-4">
            ุฎูุด ุขูุฏุ {{ user.first_name|default:user.username }}!
        </h1>
        <p class="text-gray-700 leading-relaxed text-lg">
            {% if user.is_representative %}
                ุดูุง ููุงูุฏูโ ฺฉ ุชู ูุณุชุฏ. ุงุฒ ุงู ุตูุญู ูโุชูุงูุฏ ุชู ุฎูุฏ ุฑุง ูุฏุฑุช ฺฉุฑุฏู ู ูพุฑูฺูโ ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ููุงุฏ.
            {% else %}
                ุดูุง ุนุถู ุชู ูุณุชุฏ ู ูโุชูุงูุฏ ูุถุนุช ุชู ู ูพุฑูฺูโ ุฎูุฏ ุฑุง ูุดุงูุฏู ฺฉูุฏ.
            {% endif %}
        </p>
    </section>

    <!-- ูุถุนุช ุชู ุจุง ููุงุฑ ูพุดุฑูุช -->
    <section class="bg-white border border-gray-200 shadow-lg rounded-3xl p-8 transition-all hover:shadow-xl hover:border-gray-300">
        <h2 class="text-xl font-semibold text-brand mb-5 border-b border-gray-200 pb-2">
            ูุถุนุช ุชู ุดูุง
        </h2>

        {% if user.teams.all %}
            {% for team in user.teams.all %}
                <div class="p-6 border border-gray-100 rounded-xl mb-6 bg-gray-50 hover:shadow-xl transition-all">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-5">
                        <div>
                            <p class="text-lg font-semibold text-gray-800"><strong>ูุงู ุชู:</strong> {{ team.name }}</p>
                            <p class="text-sm text-gray-600"><strong>ููุงูุฏู:</strong> {{ team.representative.get_full_name }}</p>
                            <p class="text-sm text-gray-600"><strong>ุชุนุฏุงุฏ ุงุนุถุง:</strong> {{ team.members.count }} ููุฑ</p>
                        </div>

                        {% if team.status == "draft" %}
                            <span class="px-4 py-2 rounded-md text-sm font-semibold bg-yellow-200 text-yellow-800">
                                ุฏุฑ ุญุงู ุชุดฺฉู ุชู
                            </span>
                        {% elif team.status == "submitted" %}
                            <span class="px-4 py-2 rounded-md text-sm font-semibold bg-blue-200 text-blue-800">
                                ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ ูพุฑูฺู
                            </span>
                        {% elif team.status == "assigned" %}
                            <span class="px-4 py-2 rounded-md text-sm font-semibold bg-green-200 text-green-800">
                                ูพุฑูฺู ููุง ุชุนู ุดุฏ
                            </span>
                        {% endif %}
                    </div>

                    <!-- ููุงุฑ ูพุดุฑูุช -->
                    <div class="mt-4">
                        <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                            <div class="bg-brand h-4 rounded-full transition-all duration-700"
                                 style="width:
                                         {% if team.status == 'draft' %} 30%
                                          {% elif team.status == 'submitted' %} 65%
                                          {% elif team.status == 'assigned' %} 100%
                                          {% else %} 0% {% endif %};
                                         ">
                            </div>
                        </div>

                        <p class="text-xs text-gray-500 mt-2 text-center">
                            {% if team.status == "draft" %}
                                ูุฑุญูู ฑ ุงุฒ ณ โ ุซุจุช ู ุชฺฉูู ุงุนุถุง ุชู
                            {% elif team.status == "submitted" %}
                                ูุฑุญูู ฒ ุงุฒ ณ โ ุงูุชุฎุงุจ ูพุฑูฺู ู ุงุฑุณุงู ุจุฑุง ุจุฑุฑุณ
                            {% elif team.status == "assigned" %}
                                ูุฑุญูู ณ ุงุฒ ณ โ ูพุฑูฺู ููุง ุชุฃุฏ ู ุชุฎุตุต ุฏุงุฏู ุดุฏ ๐ฏ
                            {% else %}
                                ุจุฏูู ูุถุนุช ูุดุฎุต
                            {% endif %}
                        </p>
                    </div>

                    {% if team.status == "assigned" %}
                        <div class="mt-5 text-sm">
                            <p class="font-semibold text-gray-700"><strong>ูพุฑูฺู ููุง:</strong> {{ team.final_project.title }}</p>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <div class="text-center py-10">
                {% if user.is_representative %}
                    <p class="text-gray-600 mb-5">ุดูุง ูููุฒ ุชู ุงุฌุงุฏ ูฺฉุฑุฏูโุงุฏ.</p>
                    <a href="{% url 'projects:team_create' %}"
                       class="inline-block bg-brand text-white px-8 py-3 rounded-lg shadow-md hover:bg-blue-800 transition duration-300 ease-in-out">
                        ุงุฌุงุฏ ุชู ุฌุฏุฏ
                    </a>
                {% else %}
                    <p class="text-gray-600">ุดูุง ูููุฒ ุฏุฑ ูฺ ุชู ุนุถู ูุณุชุฏ. ููุชุธุฑ ุจุงุดุฏ ุชุง ููุงูุฏูโ ุชู ุดูุง ุฑุง ุงุถุงูู ฺฉูุฏ.</p>
                {% endif %}
            </div>
        {% endif %}
    </section>

    <!-- ฺฉุงุฑุชโูุง ุฏุณุชุฑุณ ุณุฑุน -->
    <section class="space-y-6">
        <h2 class="text-xl font-semibold text-brand mb-6 border-b border-gray-200 pb-2">ุฏุณุชุฑุณ ุณุฑุน</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">

            {% if user.is_representative %}
                <a href="{% url 'projects:team_create' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ุงุฌุงุฏ ุชู</h3>
                    <p class="text-gray-600 text-sm">ุชู ุฌุฏุฏ ุจุณุงุฒ ู ุงุนุถุง ุฑุง ุงุถุงูู ฺฉู.</p>
                </a>

                <a href="{% if user.teams.first %}{% url 'projects:team_manage' user.teams.first.id %}{% else %}#{% endif %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ูุฏุฑุช ุงุนุถุง</h3>
                    <p class="text-gray-600 text-sm">ุงุนุถุง ุชู ุฑุง ุงุถุงูู ุง ุญุฐู ฺฉู.</p>
                </a>

                <a href="{% if user.teams.first %}{% url 'projects:project_select' user.teams.first.id %}{% else %}#{% endif %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ุงูุชุฎุงุจ ูพุฑูฺู</h3>
                    <p class="text-gray-600 text-sm">ุณู ูพุฑูฺูโ ููุฑุฏ ุนูุงูู ุฑุง ุจุฑุง ุชู ุงูุชุฎุงุจ ฺฉู.</p>
                </a>
            {% endif %}

            {% if user.is_staff %}
                <a href="{% url 'projects:teams_overview' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ูุฏุฑุช ุชู ูุง</h3>
                    <p class="text-gray-600 text-sm">ุงูุชุฎุงุจโูุง ุฑุง ุจุจู ู ุชู ุฑุง ูุธุงุฑู ฺฉู.</p>
                </a>
                <a href="{% url 'projects:admin_assign' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ูุฏุฑุช ูพุฑูฺูโูุง</h3>
                    <p class="text-gray-600 text-sm">ุงูุชุฎุงุจโูุง ุฑุง ุจุจู ู ูพุฑูฺูโูุง ุฑุง ุชุฎุตุต ุจุฏู.</p>
                </a>

                <a href="{% url 'projects:distribute' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ุชูุฒุน ุฎูุฏฺฉุงุฑ</h3>
                    <p class="text-gray-600 text-sm">ูพุฑูฺูโูุง ุฑุง ุฎูุฏฺฉุงุฑ ุจู ุชูโูุง ูพุฎุด ฺฉู.</p>
                </a>

                <a href="{% url 'projects:export_csv' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ุฎุฑูุฌ CSV</h3>
                    <p class="text-gray-600 text-sm">ูุณุช ุชูโูุง ู ูพุฑูฺูโูุง ุฑุง ุฏุฑุงูุช ฺฉู.</p>
                </a>
            {% endif %}
                <a href="{% url 'projects:invites_list' %}"
                   class="block bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:border-brand hover:shadow-xl transition-all">
                    <h3 class="font-bold text-brand text-lg mb-2">ุฏุนูุชโูุง ุชู</h3>
                    <p class="text-gray-600 text-sm">ูุณุช ุชูโูุง ุฏุนูุช ฺฉููุฏู ุจู ุขู ุชู ุฑุง ูุดุงูุฏู ฺฉูุฏ.</p>
                </a>
        </div>
    </section>
</div>
{% endblock %}
